var Template;!function(){"use strict";function d(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c]);return a}function e(){var a=document.createElement("div");return a.style.cssText="display: table-cell;width: 40px;padding-bottom: 19.25%;height: 0;",a}function f(){var a=document.createElement("div");return a.style.cssText="clear: both;display: table;",a}function g(a,b){a.style.cssText=a.style.cssText.concat(b.usedStyle.sprite,b.usedStyle.seat,b.usedStyle.available),a.dataset.seatId=c.available,a.addEventListener("click",b.events.availEvent,!1)}function h(a,b){a.style.cssText=a.style.cssText.concat(b.usedStyle.sprite,b.usedStyle.seat,b.usedStyle.booked),a.dataset.seatId=c.booked,a.addEventListener("click",b.events.bookedEvent,!1)}function i(a,b){a.style.cssText=a.style.cssText.concat(b.usedStyle.sprite,b.usedStyle.seat,b.usedStyle.sold),a.dataset.seatId=c.sold,a.addEventListener("click",b.events.soldEvent,!1)}function j(a,b){a.style.cssText=a.style.cssText.concat(b.usedStyle.sprite,b.usedStyle.seat,b.usedStyle.picked),a.dataset.seatId=c.picked,a.addEventListener("click",b.events.pickedEvent,!1)}function k(a,b){a.style.cssText=a.style.cssText.concat(b.usedStyle.sprite,b.usedStyle.seat,b.usedStyle.driver),a.dataset.seatId=c.driver,a.addEventListener("click",b.events.driverEvent,!1)}function l(a,b,c){c.isAlignLeft()||c.isVertical()?0==b?a.style.cssText=a.style.cssText.concat(c.usedStyle.sprite,c.usedStyle.room,c.usedStyle.toilet1):a.style.cssText=a.style.cssText.concat(c.usedStyle.sprite,c.usedStyle.room,c.usedStyle.toilet2):0==b?a.style.cssText=a.style.cssText.concat(c.usedStyle.sprite,c.usedStyle.room,c.usedStyle.toilet2):a.style.cssText=a.style.cssText.concat(c.usedStyle.sprite,c.usedStyle.room,c.usedStyle.toilet1)}function m(a,b,c){c.isAlignLeft()||c.isVertical()?0==b?a.style.cssText=a.style.cssText.concat(c.usedStyle.sprite,c.usedStyle.room,c.usedStyle.smoking1):a.style.cssText=a.style.cssText.concat(c.usedStyle.sprite,c.usedStyle.room,c.usedStyle.smoking2):0==b?a.style.cssText=a.style.cssText.concat(c.usedStyle.sprite,c.usedStyle.room,c.usedStyle.smoking2):a.style.cssText=a.style.cssText.concat(c.usedStyle.sprite,c.usedStyle.room,c.usedStyle.smoking1)}function n(a){return document.querySelector("[data-seat-number='"+a+"']")}function o(a){return a.dataset.seatNumber}function p(){return q().length}function q(){return document.querySelectorAll("[data-seat-id='"+c.picked+"']")}function r(a,b,c){for(var d in a){var e=n(a[d]);if(!s(e,c))return;b(e,c)}}function s(a,b){if(a.dataset.seatId==c.available)a.removeEventListener("click",b.events.availEvent);else if(a.dataset.seatId==c.picked)a.removeEventListener("click",b.events.pickedEvent);else if(a.dataset.seatId==c.booked)a.removeEventListener("click",b.events.bookedEvent);else{if(a.dataset.seatId!=c.sold)return!1;a.removeEventListener("click",b.events.soldEvent)}return!0}function t(a){var b=a.options.seatMatrix.split(","),c=0,d=0,n=0,o=0,p=0,q=[],r=document.querySelector(a.options.seatContainer);r.innerHTML="";for(var s in b){var t=b[s].split("-"),u=e();switch(0==n&&p++,t[2]){case"D":k(u,a);break;case"S":var v=t[3].trim();a.options.bookedSeats.map(String).indexOf(v)!==-1?h(u,a):a.options.soldSeats.map(String).indexOf(v)!==-1?i(u,a):a.options.pickedSeats.map(String).indexOf(v)!==-1?j(u,a):a.options.availableSeats.map(String).indexOf(v)!==-1?g(u,a):a.options.isRestSold?i(u,a):g(u,a),u.title="#"+v,u.dataset.seatNumber=v;break;case"T":l(u,c,a),c++;break;case"R":m(u,d,a),d++}a.isVertical()?0==o?q[n]=[u]:a.isAlignLeft()?q[n].push(u):q[n].unshift(u):(a.isAlignLeft()?0==n?q.unshift([u]):q[q.length-o-1].push(u):0==n?q[o]=[u]:q[o].push(u),p=n+1),o++,"B"==t[0]&&(n++,o=0)}for(var x in q)for(var y in q[x])q[x][y].style.paddingBottom=100/p+"%",r.appendChild(q[x][y]),y==q[x].length-1&&r.appendChild(f())}var a={sprite:"background-image:url(images/sprite_seat_vertical.png);background-repeat: no-repeat;",seat:"background-size: 1000%;",room:"background-size: 500%;",driver:"background-position:1.5% 8.2%;cursor:pointer;",available:"background-position:13.2% 8.2%;cursor:pointer",sold:"background-position:25.5% 8.2%;cursor:pointer;",booked:"background-position:38.5% 8.2%;cursor:pointer;",picked:"background-position:51.2% 8.2%;cursor:pointer",toilet1:"background-position:71.3% 8.2%;width: 80px;padding-Bottom: 9.62%;",toilet2:"display:none;",smoking1:"background-position:98.3% 8.2%;width: 80px;padding-Bottom: 9.62%;",smoking2:"display:none;"},b={sprite:"background-size: 100%;background-image: url(images/sprite_seat_horizontal.png);background-repeat: no-repeat;",seat:"",room:"",driver:"background-position: 0% 0.5%;cursor:pointer;",available:"background-position: 0% 50%;cursor:pointer;",sold:"background-position: 0% 38%;cursor:pointer;",booked:"background-position: 0% 25%;cursor:pointer;",picked:"background-position: 0% 12.5%;cursor:pointer;",toilet1:"background-position: 0% 97.8%;",toilet2:"background-position:0% 87%;",smoking1:"background-position: 0% 73.8%;",smoking2:"background-position: 0% 63%;"},c={driver:"driver",available:"available",picked:"picked",booked:"booked",sold:"sold"};Template=function(a){var b=this;this.options={align:"left",seatMatrix:null,seatContainer:null,availableSeats:[],pickedSeats:[],bookedSeats:[],soldSeats:[],isRestSold:!1,templateAlign:"horizontal",seatClicked:function(){},beforePick:function(){},clickAvailable:function(){},clickPicked:function(){},clickBooked:function(){},clickSold:function(){},clickDriver:function(){},imageDir:"images/"},this.events={availEvent:function(a){var c=b.options.beforePick(o(this),this);c||(j(this,b),this.removeEventListener("click",b.events.availEvent),b.options.clickAvailable(o(this),this))},pickedEvent:function(a){g(this,b),this.removeEventListener("click",b.events.pickedEvent),b.options.clickPicked(o(this),this)},bookedEvent:function(a){b.options.clickBooked(o(this),this)},soldEvent:function(a){b.options.clickSold(o(this),this)},driverEvent:function(a){b.options.clickDriver(o(this),this)}},this.options=d(this.options,a),this.usedStyle=this.getStyle(),t(this)},Template.prototype.getStyle=function(){var c={};return c=this.isVertical()?a:b,c.sprite=c.sprite.replace("images/",this.options.imageDir),c},Template.prototype.isVertical=function(){return!this.options.templateAlign.match(/horizontal/gi)},Template.prototype.isAlignLeft=function(){return!this.options.align.match(/right/gi)},Template.prototype.setOptions=function(a){this.options=d(this.options,a)},Template.prototype.regen=function(a){a&&(this.options=d(this.options,a)),this.usedStyle=this.getStyle(),t(this)},Template.prototype.getPickedSeats=function(){return q()},Template.prototype.getPickedSum=function(){return p()},Template.prototype.setSold=function(a){r(a,i,this)},Template.prototype.setBooked=function(a){r(a,h,this)}}();